<!doctype html>
<html lang="cs">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Vedouc√≠ ‚Ä¢ V√°noƒçn√≠ v√Ωzva 2025</title>
  <link rel="stylesheet" href="./assets/css/styles.css" />
  <!-- Volitelnƒõ: z√°kladn√≠ reset pro jistotu -->
  <style>
    /* Z√°kladn√≠ fixy pro p≈ô√≠pad, ≈æe se nƒõco ‚Äûrozbilo‚Äú v glob√°ln√≠m CSS */
    html, body { height: 100%; }
    body { margin: 0; }
    main { margin-top: 12px; } /* jemn√° mezera pod headerem */
    .tabs { display:flex; gap:8px; flex-wrap:wrap; margin-bottom:12px; }
    .tab { cursor:pointer; }
    .tabpanel.hidden { display: none; }
    .row { display:flex; gap:8px; align-items:center; }
    .stack { display:flex; flex-direction:column; gap:8px; }
    @media (max-width: 720px) {
      .row { flex-wrap: wrap; }
    }
  </style>
</head>
<body>
  <main>
    <!-- Z√ÅLO≈ΩKY -->
    <div class="tabs" role="tablist" aria-label="Nastaven√≠ manager">
      <button class="tab active" data-tab="cfg-activities" role="tab" aria-selected="true">Aktivity</button>
      <button class="tab" data-tab="cfg-milestones" role="tab" aria-selected="false">Hodnosti</button>
      <button class="tab" data-tab="cfg-roles" role="tab" aria-selected="false">Oper√°to≈ôi</button>
      <button class="tab" data-tab="cfg-utils" role="tab" aria-selected="false">N√°stroje</button>
      <button class="tab" data-tab="cfg-carousel" role="tab" aria-selected="false">Karusel</button>
    </div>

    <!-- PANEL: AKTIVITY -->
    <section id="cfg-activities" class="card tabpanel" role="tabpanel" aria-labelledby="tab-activities">
      <h2 style="margin-top:0">Nastaven√≠ aktivit</h2>
      <div class="row" style="flex-wrap:wrap">
        <input id="actName" class="input" placeholder="N√°zev aktivity" />
        <select id="actCategory" class="input">
          <option value="tel_weekly">Telefonie ‚Äì t√Ωdenn√≠</option>
          <option value="kore_static">Korespondence ‚Äì st√°l√©</option>
        </select>
        <input id="actPoints" class="input" type="number" placeholder="Body za splnƒõn√≠" />
        <input id="actDesc" class="input" placeholder="Kr√°tk√Ω popis (voliteln√©)" />
        <button class="btn" id="addActivity">P≈ôidat</button>
      </div>
      <div id="activitiesList" class="stack" style="margin-top:8px"></div>
    </section>

    <!-- PANEL: HODNOSTI -->
    <section id="cfg-milestones" class="card tabpanel hidden" role="tabpanel" aria-labelledby="tab-milestones">
      <h2 style="margin-top:0">Hodnosti</h2>
      <div class="row" style="flex-wrap:wrap">
        <input id="msThreshold" class="input" type="number" placeholder="Pr√°h bod≈Ø" />
        <input id="msLabel" class="input" placeholder="Oznaƒçen√≠ (badge)" />
        <input id="msReward" class="input" placeholder="V√Ωhra (voliteln√©)" />
        <input id="msImage" class="input" placeholder="Obr√°zek (bez p≈ô√≠pony, nap≈ô. rank_01)" />
        <label class="row" style="gap:6px"><input type="checkbox" id="msVisible" checked /> Viditeln√Ω</label>
        <button class="btn" id="addMilestone">P≈ôidat miln√≠k</button>
      </div>
      <p class="muted">Obr√°zky se berou ze slo≈æky v <code>settings/ranks_images.base_url</code>. Skryt√° hodnost pou≈æ√≠v√° vlastn√≠ obr√°zek rozmazanƒõ.</p>
      <div id="milestonesList" class="stack" style="margin-top:8px"></div>
    </section>

    <!-- PANEL: ROLE / OPER√ÅTO≈òI -->
    <section id="cfg-roles" class="card tabpanel hidden" role="tabpanel" aria-labelledby="tab-roles">
      <h2 style="margin-top:0">Oper√°to≈ôi ‚Äì role a jm√©na</h2>
      <div class="row" style="flex-wrap:wrap">
        <select id="userSelect" class="input" style="min-width:260px"></select>
        <input id="displayNameInput" class="input" placeholder="Jm√©no P≈ô√≠jmen√≠" style="min-width:220px" />
        <select id="roleSelect" class="input">
          <option value="manager">manager</option>
          <option value="operator_tel">operator_tel</option>
          <option value="operator_tel_kore">operator_tel_kore</option>
          <option value="operator_kore">operator_kore</option>
        </select>
        <button class="btn" id="assignRole">Ulo≈æit</button>
      </div>
      <p class="muted">Role se ukl√°daj√≠ do <code>roles/{uid}</code>. Jm√©no do <code>operators/{uid}.displayName</code>.</p>
      <div id="rolesList" class="stack" style="margin-top:8px"></div>
    </section>

    <!-- PANEL: N√ÅSTROJE -->
    <section id="cfg-utils" class="card tabpanel hidden" role="tabpanel" aria-labelledby="tab-utils">
      <h2 style="margin-top:0">N√°stroje</h2>
      <div class="stack">
        <div class="row" style="flex-wrap:wrap">
          <button class="btn ghost" id="recomputeLeaderboard">P≈ôepoƒç√≠tat ≈æeb≈ô√≠ƒçek (klientsky)</button>
          <button class="btn ghost" id="refreshAudits">Naƒç√≠st Audit bod≈Ø</button>
        </div>
        <div class="stack">
          <label for="weeklyInfoManager">Kr√°tk√Ω popis pro sekci ‚ÄûTento t√Ωden‚Äù</label>
          <textarea id="weeklyInfoManager" class="input" rows="3" placeholder="Nap≈ô. **D≈Øle≈æit√©**: tento t√Ωden bƒõ≈æ√≠ speci√°ln√≠ sprint‚Ä¶"></textarea>
          <div class="row" style="justify-content:flex-end"><button class="btn" id="saveWeekInfo">Ulo≈æit popis t√Ωdne</button></div>
        </div>
        <div id="auditsList" class="stack" style="margin-top:8px"></div>
      </div>
      <p class="muted">Pozn.: Bez Cloud Functions prob√≠h√° p≈ôepoƒçet na klientovi. ≈Ωeb≈ô√≠ƒçek je ze souƒçtu dokument≈Ø v <code>logs</code>. Audit v <code>audits</code>.</p>
    </section>

    <!-- PANEL: KARUSEL -->
<section id="cfg-carousel" class="card tabpanel hidden">
  <h2 style="margin-top:0">Karusel ‚Äì obr√°zky a popisky</h2>

  <!-- Nastaven√≠ -->
  <div class="stack" style="margin-bottom:12px">
    <div class="row" style="flex-wrap:wrap; gap:8px">
      <input id="carBaseUrl" class="input" placeholder="Base URL na GitHubu (bez koncov√©ho /), nap≈ô. https://raw.githubusercontent.com/‚Ä¶/main/images" />
      <input id="carCount" class="input" type="number" placeholder="Poƒçet sn√≠mk≈Ø (N)" style="max-width:160px" />
      <button class="btn" id="carSaveCfg">Ulo≈æit nastaven√≠</button>
    </div>
    <div class="md-help">
      Soubory obr√°zk≈Ø na GitHubu: <code>P1..PN</code> s p≈ô√≠ponami <code>.jpg/.jpeg/.png/.webp</code> (zkou≈°√≠ se automaticky).<br>
      Popisky podporuj√≠ <b>Markdown</b> (tuƒçn√©, kurz√≠va, odr√°≈æky, citace, odkazy) a emoji üòä.
    </div>
  </div>

  <!-- Editor sn√≠mk≈Ø -->
  <div id="carSlidesForm" class="stack"></div>
</section>

  </main>

  <!-- Skripty: UI (header, footer, sn√≠h, SVG pozad√≠), guard a logika manageru -->
  <script type="module">
    import { initTheme, initChrome } from './assets/js/ui.js?v=2025-11-01-2';
    import { guard } from './assets/js/auth-guard.js?v=2025-11-01-1';
    import './assets/js/manager.js?v=2025-11-01-2';

    // Nastav√≠ t√©ma, vykresl√≠ header+footer+pozad√≠ a zkontroluje opr√°vnƒõn√≠ mana≈æera
    initTheme();
    initChrome();
    guard({ requireAuth: true, requireManager: true, onReady(){} });

    // Jednoduch√Ω tab-switcher (pro p≈ô√≠pad, ≈æe glob√°ln√≠ logika chyb√≠)
    const tabs = document.querySelectorAll('.tabs .tab');
    const panels = document.querySelectorAll('.tabpanel');
    tabs.forEach(btn=>{
      btn.addEventListener('click', ()=>{
        tabs.forEach(b=>{ b.classList.remove('active'); b.setAttribute('aria-selected','false'); });
        panels.forEach(p=>p.classList.add('hidden'));
        btn.classList.add('active'); btn.setAttribute('aria-selected','true');
        document.getElementById(btn.dataset.tab)?.classList.remove('hidden');
      });
    });
  </script>
</body>
</html>
